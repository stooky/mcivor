---
/**
 * ArticleSchema Component
 * Generates JSON-LD structured data for blog posts
 * Helps Google display article rich results with author, date, etc.
 */
import { siteConfig } from '../../config/site';

interface Props {
  title: string;
  description: string;
  image?: string;
  publishedDate: Date;
  modifiedDate?: Date;
  author?: string;
}

const {
  title,
  description,
  image,
  publishedDate,
  modifiedDate,
  author = siteConfig.name
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, siteConfig.url).href;
const imageURL = image ? new URL(image, siteConfig.url).href : `${siteConfig.url}${siteConfig.defaultOgImage}`;

const schema = {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": title,
  "description": description,
  "image": imageURL,
  "datePublished": publishedDate.toISOString(),
  "dateModified": (modifiedDate || publishedDate).toISOString(),
  "author": {
    "@type": "Organization",
    "name": author,
    "url": siteConfig.url
  },
  "publisher": {
    "@type": "Organization",
    "name": siteConfig.name,
    "logo": {
      "@type": "ImageObject",
      "url": `${siteConfig.url}/images/logo.png`
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": canonicalURL
  }
};
---

<script type="application/ld+json" set:html={JSON.stringify(schema)} />
